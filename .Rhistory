geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = c(screen.lower.N, screen.upper.N)), col = "green")
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "green")
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue")
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(x = 1250, y = ymin,
aes(label = paste0("RMSE: ", round(rmse, 3))),
data = trial.summary)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(x = 1250, y = Inf, hjust = 1,
aes(label = paste0("RMSE: ", round(rmse, 3))),
data = trial.summary)
trial.summary <- raw.data.long %>%
group_by(subject, trial, center.N) %>%
summarise(rmse = sqrt(mean((newtons-center.N)^2))) %>%
ungroup() %>%
group_by(trial)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(x = 1250, y = Inf, hjust = 1,
aes(label = paste0("RMSE: ", round(rmse, 3))),
data = trial.summary)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(. ~ trial) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(x = 1250, y = Inf, hjust = 1,
aes(label = paste0("RMSE: ", round(rmse, 3))),
data = trial.summary)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = trial.summary)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = trial.summary[trial.summary$subject == subject.vec[i]])
trial.summary <- raw.data.long %>%
group_by(subject, trial, center.N) %>%
summarise(rmse = sqrt(mean((newtons-center.N)^2))) %>%
ungroup()
trial.summary[trial.summary$subject == subject.vec[i]]
View(trial.summary)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(as.factor(trial) ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = trial.summary[trial.summary$subject == subject.vec[i]])
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = trial.summary[trial.summary$subject == subject.vec[i]])
View(trial.summary)
df.sd.hp <- mtcars %>%
group_by(cyl) %>%
summarise(hp.sd = round(sd(hp), 2))
View(df.sd.hp)
ggplot(data = mtcars, aes(x = hp)) +
geom_dotplot(binwidth = 1) +
geom_density() +
facet_grid(. ~ cyl) +
geom_text(x = 200, y = 0.75,
aes(label = paste0("SD: ", hp.sd)),
data = df.sd.hp)
tmp <- filter(raw.data.long, subject == subject.vec[i]) %>%
select(-subject)
labels <- filter(trial.summary, subject == subject.vec[i]) %>%
select(trial, rmse)
p <- ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels)
p
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels)
View(trials.valid)
trial.summary <- raw.data.long %>%
group_by(subject, trial, center.N) %>%
summarise(rmse = sqrt(mean((newtons-center.N)^2))) %>%
ungroup() %>%
mutate(valid.points = force.valid$valid.newtons)
subject.vec <- ungroup(trial.summary) %>%
distinct(subject) %>%
select(subject) %>%
collect %>% .[["subject"]]
labels <- filter(trial.summary, subject == subject.vec[i]) %>%
select(trial, rmse, valid.points)
View(labels)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels)
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
theme_classic()
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
theme_bw()
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i]) +
theme_bw()
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1.5,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1.5,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1.5,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1.2,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
# Create list for plot capture
plot_list = list()
# Make plots
for (i in 1:length(subject.vec)) {
tmp <- filter(raw.data.long, subject == subject.vec[i]) %>%
select(-subject)
labels <- filter(trial.summary, subject == subject.vec[i]) %>%
select(trial, rmse, valid.points)
p <- ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ .) +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
plot_list[[i]] <- p
}
# Write plots
pdf("./Plots/Trial Validation.pdf")
for (i in 1:length(subject.vec)) {
print(plot_list[[i]])
}
dev.off
pdf("Plots/Trial Validation.pdf")
for (i in 1:length(subject.vec)) {
print(plot_list[[i]])
}
# Create list for plot capture
plot_list = list()
# Make plots
for (i in 1:length(subject.vec)) {
tmp <- filter(raw.data.long, subject == subject.vec[i]) %>%
select(-subject)
labels <- filter(trial.summary, subject == subject.vec[i]) %>%
select(trial, rmse, valid.points)
p <- ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ ., scales = "free") +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 1250, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 1750, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
plot_list[[i]] <- p
}
# Write plots
pdf("Trial Validation.pdf")
for (i in 1:length(subject.vec)) {
print(plot_list[[i]])
}
dev.off
dev.off()
# Create list for plot capture
plot_list = list()
# Make plots
for (i in 1:length(subject.vec)) {
tmp <- filter(raw.data.long, subject == subject.vec[i]) %>%
select(-subject)
labels <- filter(trial.summary, subject == subject.vec[i]) %>%
select(trial, rmse, valid.points)
p <- ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ ., scales = "free") +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 500, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 2000, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
plot_list[[i]] <- p
}
# Write plots to Plots folder
my.dir <- getwd()
setwd <- ("./Plots")
pdf("Trial Validation.pdf")
for (i in 1:length(subject.vec)) {
print(plot_list[[i]])
}
# Create list for plot capture
plot_list = list()
# Make plots
for (i in 1:length(subject.vec)) {
tmp <- filter(raw.data.long, subject == subject.vec[i]) %>%
select(-subject)
labels <- filter(trial.summary, subject == subject.vec[i]) %>%
select(trial, rmse, valid.points)
p <- ggplot(data = tmp, aes(x = xvals, y = newtons)) +
facet_grid(trial ~ ., scales = "free") +
geom_line() +
xlim(0, 2500) +
geom_hline(aes(yintercept = center.N), col = "blue") +
geom_hline(aes(yintercept = screen.lower.N), col = "blue") +
geom_hline(aes(yintercept = screen.upper.N), col = "blue") +
geom_text(aes(x = 500, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("RMSE: ", round(rmse, 3)),
group = NULL),
data = labels) +
geom_text(aes(x = 2000, y = Inf, hjust = 1, vjust = 1.1,
label = paste0("Points in view: ", round(valid.points*100, 2), "%"),
group = NULL),
data = labels) +
ggtitle(paste("Participant: ", subject.vec[i])) +
theme_bw()
plot_list[[i]] <- p
}
# Write plots to Plots folder
my.dir <- getwd()
setwd <- ("./Plots")
pdf("Trial Validation.pdf")
for (i in 1:length(subject.vec)) {
print(plot_list[[i]])
}
raw.data <- read.csv("./Data Files/Raw_Vision.csv")
source('~/GitHub/Dissertation/R Script files/Trial Validation.R')
source('~/GitHub/Dissertation/R Script files/Trial Validation.R')
source('~/GitHub/Dissertation/R Script files/Trial Validation.R')
source('~/GitHub/Dissertation/R Script files/Trial Validation.R')
source('~/GitHub/Dissertation/R Script files/Trial Validation.R')
source('~/GitHub/Dissertation/R Script files/Trial Validation.R')
View(trial.summary)
rm(
list = c(
"p", "plot_list", "subject.vec", "i", "tmp", "labels", "raw.data.long", "raw.data"
)
)
View(force.valid)
rm(
list = c(
"p", "plot_list", "subject.vec", "i", "tmp", "labels", "raw.data.long",
"raw.data", "my.dir", "force.valid"
)
)
source('C:/Users/a01382606/Desktop/Force Tracking/R Script files/Trial Validation.R')
View(trial.summary)
mmse.data <- read.csv("./Data Files/MMSE_Vision.csv", header = TRUE, sep = ",")
View(mmse.data)
View(trial.summary)
mmse.detrended.data <- read.csv("./Data Files/Detrended_Vision.csv", header = TRUE, sep = ",") %>%
select(-X)
View(mmse.detrended.data)
mmse.data <- read.csv("./Data Files/MMSE_Vision.csv", header = TRUE, sep = ",") %>%
select(-X)
View(trial.summary)
gsub("[A-z]", "", mmse.data)
tmp <- gsub("[A-z]", "", mmse.data)
str(mmse.data)
editVars <- function(x) {
# This function changes subject and trial variables from strings to numeric.
require(dplyr)
gsub("[A-z]", "", mmse.data)
}
mutate_if(mmse.data, is.factor(), funs(editVars))
mutate_if(mmse.data, is.factor(.), funs(editVars))
mutate_if(mmse.data, is.factor, funs(editVars))
editVars <- function(x) {
# This function changes subject and trial variables from strings to numeric.
require(dplyr)
gsub("[A-z]", "", x)
}
mutate_if(mmse.data, is.factor, funs(editVars))
editVars <- function(x) {
# This function changes subject and trial variables from strings to numeric.
gsub("[A-z]", "", x)
}
str(trial.summary)
prepSubs <- function(x) {
# This function will call manipulation functions to edit strings to numeric or
# factor. Broadly, the purpose of this function is to convert the variable
# columns prepended with a letter from strings/factors to numeric.
# Load dplyr if not already loaded
require(dplyr)
# Pass dataframe to editVars
mutate_if(x, is.factor | is.character, funs(editVars)) %>%
mutate_if(is.factor | is.character, as.numeric)
}
tmp <- prepSubs(mmse.data)
prepSubs <- function(x) {
# This function will call manipulation functions to edit strings to numeric or
# factor. Broadly, the purpose of this function is to convert the variable
# columns prepended with a letter from strings/factors to numeric.
# Load dplyr if not already loaded
require(dplyr)
# Pass dataframe to editVars
mutate_if(x, is.factor, funs(editVars)) %>%
mutate_if(is.factor, as.numeric)
}
tmp <- prepSubs(mmse.data)
str(tmp_)
str(tmp)
